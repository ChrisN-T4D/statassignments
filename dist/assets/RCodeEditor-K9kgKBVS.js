import{_ as A,r as d,c as $,a as F,o as r,w as H,b as o,d as u,e as m,i as N,F as b,f as w,t as x,j as P,k as V,v as Y,n as K,g as D,l as C}from"./index-ByDZiPpy.js";import{B as I}from"./BaseSimulator-BPP_QgrQ.js";const Q={class:"r-interface"},z={class:"editor-container"},L={class:"editor-body"},U={class:"line-numbers"},W=["onKeydown","placeholder"],G={class:"console-container"},J={class:"console-header"},X=["disabled"],Z={key:0,class:"prompt"},S={key:1,class:"error-prefix"},ee={key:0,class:"console-placeholder"},te={key:0,class:"expected-output"},se={__name:"RCodeEditor",props:{task:{type:Object,required:!0}},emits:["correct","incorrect"],setup(l,{expose:_,emit:E}){const i=l,g=E,n=d(i.task.starterCode||""),c=d([]),p=d(!1),f=d(null),h=d(null),R=$(()=>{const t=n.value.split(`
`).length;return Math.max(t,10)});function M(t){const e=t.target.selectionStart,s=t.target.selectionEnd;n.value=n.value.substring(0,e)+"  "+n.value.substring(s),C(()=>{t.target.selectionStart=t.target.selectionEnd=e+2})}function q(){c.value.push({type:"input",text:n.value.split(`
`).join(`
> `)});const t=O(n.value);c.value.push(...t),C(()=>{h.value&&(h.value.scrollTop=h.value.scrollHeight)})}function O(t){const e=[];t.includes("mean(")&&t.match(/mean\(([^)]+)\)/)&&e.push({type:"output",text:"[1] 45.2"}),t.includes("sd(")&&e.push({type:"output",text:"[1] 12.34"}),t.includes("summary(")&&e.push({type:"output",text:`   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
  12.00   34.25   45.00   45.20   56.75   78.00`}),t.includes("t.test(")&&e.push({type:"output",text:`
	One Sample t-test

data:  x
t = 2.345, df = 29, p-value = 0.0261
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 1.234567 8.765432
sample estimates:
mean of x 
    5.000`}),(t.includes("cor(")||t.includes("cor.test("))&&e.push({type:"output",text:"[1] 0.7234"}),t.includes("lm(")&&e.push({type:"output",text:`
Call:
lm(formula = y ~ x)

Coefficients:
(Intercept)            x  
      2.345        0.789`});const s=(t.match(/\(/g)||[]).length,a=(t.match(/\)/g)||[]).length;return s!==a?(e.push({type:"error",text:"unexpected end of input"}),e):(e.length===0&&t.trim()&&e.push({type:"output",text:"# Code executed (no output)"}),e)}function B(){const t=i.task.expectedCode||{};let e=!0,s="";if(t.patterns){for(const a of t.patterns)if(!new RegExp(a,"i").test(n.value)){e=!1,s="Your code is missing some required elements.";break}}if(t.requiredFunctions&&e){for(const a of t.requiredFunctions)if(!new RegExp(`\\b${a}\\s*\\(`,"i").test(n.value)){e=!1,s=`Your code should use the ${a}() function.`;break}}if(t.requiredArgs&&e)for(const[a,v]of Object.entries(t.requiredArgs)){const y=n.value.match(new RegExp(`${a}\\s*\\(([^)]+)\\)`,"i"));if(y){const T=y[1];for(const j of v)if(!T.includes(j)){e=!1,s=`Check the arguments you're passing to ${a}().`;break}}}e?(f.value={type:"correct",message:i.task.successMessage||"Your R code is correct!"},g("correct")):(f.value={type:"incorrect",message:s||i.task.failureMessage||"Your code needs some adjustments. Try again!"},g("incorrect"))}function k(){n.value=i.task.starterCode||"",c.value=[],f.value=null,p.value=!1}return _({reset:k}),(t,e)=>(r(),F(I,{software:"r",task:l.task,"can-check":n.value.trim().length>0,"show-hint":p.value,"show-reset":n.value!==l.task.starterCode,feedback:f.value,onCheckAnswer:B,onReset:k,onShowHint:e[1]||(e[1]=s=>p.value=!0)},{default:H(()=>[o("div",Q,[o("div",z,[e[2]||(e[2]=o("div",{class:"editor-header"},[o("span",{class:"editor-title"},"R Script"),o("span",{class:"file-indicator"},"untitled.R")],-1)),o("div",L,[o("div",U,[(r(!0),u(b,null,w(R.value,s=>(r(),u("div",{key:s,class:"line-number"},x(s),1))),128))]),N(o("textarea",{"onUpdate:modelValue":e[0]||(e[0]=s=>n.value=s),class:"code-input",spellcheck:"false",onKeydown:P(V(M,["prevent"]),["tab"]),placeholder:l.task.placeholder||"# Write your R code here..."},null,40,W),[[Y,n.value]])])]),o("div",G,[o("div",J,[e[3]||(e[3]=o("span",null,"Console",-1)),o("button",{class:"run-btn",onClick:q,disabled:!n.value.trim()}," Run Code ",8,X)]),o("div",{class:"console-output",ref_key:"consoleEl",ref:h},[(r(!0),u(b,null,w(c.value,(s,a)=>(r(),u("div",{key:a,class:K(["output-line",s.type])},[s.type==="input"?(r(),u("span",Z,"> ")):m("",!0),s.type==="error"?(r(),u("span",S,"[Error] ")):m("",!0),D(" "+x(s.text),1)],2))),128)),c.value.length===0?(r(),u("div",ee," Run your code to see output here ")):m("",!0)],512)]),l.task.showExpectedOutput&&p.value?(r(),u("div",te,[e[4]||(e[4]=o("strong",null,"Expected output pattern:",-1)),o("pre",null,x(l.task.expectedOutputHint),1)])):m("",!0)])]),_:1},8,["task","can-check","show-hint","show-reset","feedback"]))}},ae=A(se,[["__scopeId","data-v-50220d1a"]]);export{ae as default};
